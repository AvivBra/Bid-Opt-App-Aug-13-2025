# השוואת פורטפוליוז - מפרט תמציתי

## מטרה
זיהוי פורטפוליוז חסרים ועודפים בין הבלק המנוקה לוירטואל מאפ.

## קלט
1. רשימת פורטפוליוז מהבלק המנוקה
2. וירטואל מאפ (פורטפוליוז מהטמפלט)
3. רשימת פורטפוליוז מסומנים כאיגנור

## לוגיקת השוואה

| סוג | הגדרה |
|-----|--------|
| **חסרים** | קיימים בבלק המנוקה, לא בוירטואל מאפ, לא באיגנור |
| **עודפים** | קיימים בוירטואל מאפ, לא בבלק המנוקה |

## פלט
```python
{
    "missing": ["Port_A", "Port_B"],
    "excess": ["Port_X", "Port_Y"]
}
```

## תרשים זרימה

```
[השוואת פורטפוליוז]
    ↓
[בדיקת תוצאות]
    ├─[אין חסרים/עודפים] → [טריגור סטפ 3]
    ├─[חסרים בלבד] → [לולאה*]
    ├─[עודפים בלבד] → [הצגת עודפים] + [כפתור העתקה] + [טריגור סטפ 3]
    └─[חסרים + עודפים] → [הצגת עודפים] + [כפתור העתקה] + [לולאה*]

*ראה תרשים לולאת השלמה למטה
```

## תרשים לולאת השלמה

```
[לולאת השלמה]
    ↓
[יצירת Completion Template עם פורטפוליוז חסרים]
    ↓
[הורדת הקובץ ע"י המשתמש]
    ↓
[מילוי Base Bid (חובה) + Target CPA (אופציונלי)]
    ↓
[העלאת Completion Template חזרה]
    ↓
[ולידציה]
    ├─[תקין] → [מיזוג לוירטואל מאפ] → [ניקוי בלק מחדש] → [חזרה להשוואה]
    └─[שגיאה] → [הצגת שגיאה] → [חזרה להעלאה]
```

## הערות
- השוואה רגישה לאותיות גדולות/קטנות
- פורטפוליוז באיגנור לא נחשבים כחסרים
- ההשוואה מתבצעת אחרי הניקוי הראשוני

## דוגמה

| מקור | פורטפוליוז |
|-------|------------|
| בלק מנוקה | [A, B, C, D] |
| וירטואל מאפ | [C, D, X, Y] |
| איגנור | [E] |

**תוצאה:**
- חסרים: [A, B]
- עודפים: [X, Y]